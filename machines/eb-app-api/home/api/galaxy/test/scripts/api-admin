#!/bin/bash
set -e

# ------------------------------------------------------------------------------
# this works only in trusted network
# ------------------------------------------------------------------------------

# ------------------------------------------------------------------------------
# environment
# ------------------------------------------------------------------------------
BASEDIR=$(dirname $0)
source $BASEDIR/common

header <<< "/api/admin started"
rm -f /tmp/api-admin-*

# ------------------------------------------------------------------------------
# /api/admin/hello
# ------------------------------------------------------------------------------
curl -ks -X POST https://$APP_FQDN/api/admin/hello \
    --output-dir /tmp --output api-admin-hello \
    -H "Accept: application/json"
res=$(jq -r .text /tmp/api-admin-hello)
[[ "$res" = "null" ]] && exit 1

out <<< "/api/admin/hello"
out <<< "  $res"

# ------------------------------------------------------------------------------
# completed
# ------------------------------------------------------------------------------
footer <<< "/api/admin completed"
